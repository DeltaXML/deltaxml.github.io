<!DOCTYPE HTML><html lang="en">

<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	

	<!-- Basic Page Needs
							==================================================-->

	<title>VS Code XSLT/XPath</title>
	<meta name="description" content="User Guide for DeltaXML's XSLT/XPath Editor extension for Visual Studio Code.">
	<meta name="author" content="Philip Fearon">

	<!-- Mobile Specific Metas
							==================================================-->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
							==================================================-->
	<link rel="stylesheet" href="./resources/base.css">
	<link rel="stylesheet" href="./resources/skeleton.css">
	<link rel="stylesheet" href="./resources/layout.css">
	<link rel="stylesheet" href="./resources/custom.css">


	<!-- Favicons
							==================================================-->
	<link rel="icon" href="resources/tiny-white-logo.png" sizes="32x32">

</head>

<body>



	<!-- Primary Page Layout
							==================================================-->

	<!-- Delete everything in this .container and get started on your own site! -->
	<div class="colorBar">&nbsp;</div>
	<div class="topbar">
		<div class="container">
			<div class="six columns" style="padding-left: 20px;">
				<a href="https://www.deltaxml.com/">
					<img src="resources/deltaxml-logo.png" width="70px" style="float: left; padding-top: 10px;">
					<p style="float: left; padding: 20px 5px 0px 10px; color: #c2e664; text-align: center;">VS
						Code<br>Extension<br><span style="font-size: x-small;">By DeltaXML</span></p>
				</a>
			</div>
			<div class="six columns topTitle">
				<h3 class="remove-bottom" style="color: white">XSLT and XPath</h3>
				<h5 style="color: white;">for Visual Studio Code</h5>
			</div>
		</div>
	</div>
	<div class="wrapper">
		<nav>
			<ul>
				<li><a href="index.html">Overview</a></li>
				<li><a href="editing.html">Editing XML</a></li>
				<li><a href="editing-xslt.html" class="active">Editing XSLT/XPath</a></li>
				<li><a href="navigation.html">Code Navigation</a></li>
				<li><a href="run-xslt.html">Running XSLT</a></li>
				<li><a href="refactoring-xslt.html">Refactoring: Extract to xsl:function</a></li>
				<li><a href="xpath-notebook.html">XPath Notebooks</a></li>
				<li><a href="settings.html">Settings</a></li>
			</ul>
		</nav>
		<div class="main"><h2 class="pageTitle">Editing XSLT/XPath</h2>
		
		<div class="two-thirds column">
			<p>With <a href="https://marketplace.visualstudio.com/items?itemName=deltaxml.xslt-xpath">DeltaXML's XSLT/XPath extension</a>
				, Visual Studio Code is now a fully featured
				XSLT 3.0 editor. Standalone XPath 3.1 files are also fully supported. Visual Studio Code's rich ecosystem
				is now available to XSLT and XPath developers.</p>
			
			<p>Comprehensive, but language-neutral, descriptions of Visual Studio Code can be found in Microsoft's 
				<a href="https://code.visualstudio.com/docs/editor/codebasics"> Visual Studio Code User Guide. Links to key sections are below:</a></p>
			<ul>
				<li><a href="https://code.visualstudio.com/docs/editor/codebasics#_keyboard-shortcuts">Keyboard shortcuts</a></li>
				<li><a href="https://code.visualstudio.com/docs/editor/codebasics#_multiple-selections-multicursor">Multiple selections (multi-cursor)</a></li>
				<li><a href="https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace">Find and Replace</a></li>
				<li><a href="https://code.visualstudio.com/docs/editor/codebasics#_file-encoding-support">File encoding support</a></li>
				<li><a href="https://code.visualstudio.com/docs/editor/emmet">Emmet (snippet abbreviations)</a></li>
			</ul>
			<p>The documentation here focuses on XSLT and XPath language features. More general XML features are
				covered on the <a href="editing.html">Editing XML</a> page. 
				Help on navigating code in the editor is provided in the <a href="navigation.html">Code Navigation</a> page.</p>
			<h3 id="highlighting">Syntax Highlighting</h3>
			
			<p class="caption"><em>Eva Dark Theme</em></p>
			<img src="resources/dark-eva.png" class="scale-with-grid">		
			
			<p>For improved performance and precision, this extension eschews the default 
				but <a href="https://github.com/microsoft/vscode/issues/77140">problematic TM Grammar</a>
				and instead uses Visual Studio Code's
				<a href="https://code.visualstudio.com/api/language-extensions/semantic-highlight-guide">Semantic Highlighting</a> introduced in 2020.
				feature. For external <a href="https://code.visualstudio.com/docs/getstarted/themes">color themes</a> you should explicitly enable Semantic Highlighting. See
				the <a href="settings.html">Settings</a> page for more information.
			</p>
			
			<p class="caption"><em>Github Light Theme</em></p>		
			<img src="resources/light-github.png" class="scale-with-grid" style="border-style: solid; border-width: 1px">
			
			<p>The extension provides syntax highlighting for XSLT instructions, XML Literal Result Elements, XML attributes, XML character references, CDATA sections 
				and all tokens within XPath expressions. XPath expressions within Attribute Value Templates (AVTs) and 
				Text Value Templates are syntax highlighted also.</p>
			
			<h4>XSLT/XPath Dark Color Themes</h4>
			<p>The plethora of VS Code themes will highlight XSLT/XPath very well using Semantic Highlighting fallbacks for language-specific tokens. 
				There is however a <a href="https://marketplace.visualstudio.com/items?itemName=deltaxml.xslt-dark-themes">XSLT Dark Themes</a> 
				extension that enhances a set of popular dark themes specifically for XSLT and XPath:
			</p>
			<ol>
				<li>Darcula From IntelliJ</li>
				<li>Gruvbox Material Dark</li>
				<li>Iceberg</li>
				<li>Nord</li>
				<li>Tokyo Night Storm</li>
				<li>Zen</li>
			</ol>
			
		</div>
		<h3 id="formatting">Formatting</h3>
		<p>Two commands are provided for formatting XML, XSLT or XPath expressions:</p>
		<ul>
			<li><strong>Format Document</strong> <span class="shortcut">(⇧⌥F)</span> - Format the entire active file.</li>
			<li><strong>Format Selection</strong> <span class="shortcut">(⌘K ⌘F)</span> - Format the selected content.</li>
			<li><strong>Format on Save</strong> - Optionally specify to format only modifications.</li>
		</ul>
		<p>As well as explicitly invoking commands, formatting can be triggered as you type, 
			when you save a file, or when you paste content from the clipboard. The following settings control this:</p>
		<ul>
			<li><code>editor.formatOnType</code> - Controls indentation for new lines.</li>
			<li><code>editor.formatOnSave</code> - Controls indentation for new lines.</li>
			<li><code>editor.formatOnPaste</code> - Controls indentation for new lines.</li>
			<li><code>editor.editor.formatOnSaveMode</code> - <em>modifications</em> setting, only formats code changes on save.</li>
		</ul>
		<p>The XPath formatter indents code blocks within <code>{}</code>, <code>[]</code> and <code>()</code> bracket-pairs.
			Indentation is also adjusted for <code>if/else</code> blocks and range-variable blocks.	
		</p>
		<h3>Folding</h3>
		<p>
			Folding with this extension uses indentation to determine fold regions.
			To set a region code-folding block, surround it with <code>&lt;?region?&gt;</code> and <code>&lt;?endregion?&gt;</code> processing instructions.
			You may optionally include a label for the processing instructions, for example:
		</p>
		<code class="block">&lt;?region modeA?&gt;
...
&lt;?endregion modeA?&gt;</code>
		<p>For more detail and a full list of Folding-related actions see the
			<a href="https://code.visualstudio.com/docs/editor/codebasics#_folding">Folding</a> section in Visual Studio Code's User Guide.</p>
		<h3 id="intellisense">Intellisense (Auto Complete)</h3>
		<p>Intellisense suggestions include all in-scope XSLT and XPath symbols from <code>xsl:accumulator</code> names
			to <code>xsl:variable</code> names, to anonymous XPath function parameters. There is intellisense
			also for XSLT and XPath functions - help for built-in functions is shown alongside the suggestions list. Symbols from
			included/imported files are included in the suggestions list.</p>
		<h5>Intellisense for XPath Locations</h5>
		<p>An XML source file is used for context to provide XML node-names when editing XPath location steps. 
			This is the last non-XSLT file opened in Visual Studio Code.</p>
		<img src="resources/xpath-auto-complete.png" class="scale-with-grid">
		<p>XPath is evaluated as you type so node-names in the auto-completion list are filtered to be just
		those that are possible given previous XPath steps such as axes and node-name tests.</p>
		<h5>Triggering the auto-complete list</h5>
		<p>For XSLT intellisense, the <span class="shortcut">&lt;</span> character triggers suggestions. XSLT instruction suggestions
			fit the context of the curstor location. 
			On accepting a suggestion a <a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets">Code Snippet</a> is inserted
			which will include common attributes for the selected instruction.
		</p>
		<p>Intellisense is manually triggered with <span class="shortcut">⌃Space</span>, with <span class="shortcut">Tab</span> or 
			<span class="shortcut">Enter</span> used to accept suggestions. These <a href="">key bindings</a> are fully customizable.</p>
		<h5>XSLT Instruction Snippets</h5>
		<p>The special <code>xsl:stylesheet</code> suggestion includes a boiler plate 'identity transform' stylesheet complete with namespace
			declarations.</p>
		<p>The <code>xsl:message</code> suggestions include a <em>Watch Variables</em> snippet that lists the names and values of all
			the immediate in-scope variables or parameters.</p>
		<h5>More Snippets</h5>
		<p>
			You can define your own snippets in Visual Studio Code in a declarative way, without writing an extension. See the Visual Studio Code
			documentation:
			<a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets#_create-your-own-snippets">Create your own snippets</a>.
		</p>
		<p><strong>Emmet Snippets</strong> provide a useful shorthand for inserting literal result elements. They can be enabled for XSLT
			in <a href="settings.html">Visual Studio Code Settings</a>.	
		</p>
		<h3>Bracket Matching</h3>
		<p>Matching brackets in XPath expressions are highlighted when the cursor is near one of them. You can jump to the matching
			bracket with <span class="shortcut">⇧⌘\</span></p>
		
		
		<h3 id="renaming">Symbol Renaming</h3>
		
		<p>The <strong>Rename Symbol</strong> command <span class="shortcut">F2</span> (available in the context-menu) updates all in-scope usages of the symbol - across all
			imported stylesheet modules. Press <span class="shortcut">⇧Enter</span> to preview the updates or <span class="shortcut">Enter</span>
			to perform updates immediately.
		</p>
		
		<h3 id="refactoring">Code Refactoring</h3>
		<p>Code refactoring features like <strong>Extract xsl:function</strong> and <strong>Extract xsl:template</strong> are provided via VS Code's 
			Quick Fix (<span class="shortcut">⌘</span><span class="shortcut">.</span>) feature and the 
			<span class="shortcut">Refactor</span> command.</p>
		<p>An available refactoring for a selection is indicated by a light-bulb💡 adjacent to the selection. Clicking on the 💡 will display the available refactorings.
			The light-bulb is only shown when the code selection is a valid expression or a set of XSLT instructions that would be valid inside the new component.
			If you don't see the light-bulb when you expect to, check that the code selection <strong>completely encloses</strong> the XSLT instruction or XPath expression.
		</p>
		<p>The name of an extracted new component should be changed with the <span class="shortcut">Rename Symbol</span> feature, this is automatically triggered when the new component is added.</p>
		<p>After refactoring, the XSLT is updated to fix any context problems introduced when code is moved.
			The new component has <code>xsl:param</code> instructions added to provide context-properties required.
			For extract to xsl:function two modes are available (fully documented <a href="refactoring-xslt.html">here</a>):
		</p>
		<ul>
			<li>
			<strong>full refactoring</strong> - fixes 'missing-context' problems by updating XSLT to reference the context-property parameters.
			</li>
			<li>
			<strong>partial refactoring</strong> - highlights 'missing context' problems in the XSLT.
			</li>
		</ul>
		<p>
		<img src="resources/refactoring.png" class="scale-with-grid">
			<emphasis>Refactoring with 'Extract to xsl:function' in full mode, referencing context-parameters $c.x, $c.p and $c.l</emphasis>

		</p>
		<h3 id="checking">XSLT Linter</h3>
		<aside>Note: The XSLT Linter uses a Symbol Provider. To ensure checks are performed you should keep the
			<a href="https://code.visualstudio.com/Docs/editor/editingevolved#_breadcrumbs">Breadcrumbs</a> view enabled.</aside>
		<p>
			The XSLT/XPath linter performs checks on your code as you type, peforming symbol reference tests across all included modules. 
			Any problems are shown in the Problems Panel and also highlighted inline with a squiggly
			underline for the specific token at issue.
			Here is a summary of the key checks:
		</p>
		<ol>
			<li>XML Syntax</li>
			<li>XSLT/XPath Variable name references</li>
			<li>XSLT/XPath Parameter name references</li>
			<li><strong>All</strong> other symbol name refererences (<code>xsl:accumulator</code> <code>xsl:key</code> etc.)</li>
			<li>Function name and arity (number of params)</li>
			<li><code>xsl:with-param</code> names</li>
			<li>File locations in <code>xsl:import</code> <code>xsl:include</code> <code>xsl:use-package</code></li>
			<li>Order of operators/operands in XPath</li>
			<li>Matching of brackets in XPath</li>
			<li>Presence of the context-item for expressions where it is required</li>
			<li>XSLT instructions and their attributes</li>
			<li>Duplicate global symbol names</li>
			<li>Attribute Value Template Syntax</li>
			<li>Text Value Template Syntax</li>			
		</ol>
		<h5>Inferred Imports for 'Non-Standalone' Stylesheets</h5>
		<p>Non-standalone XSLT stylesheet modules have missing imports because they are imported by a parent module
			that declares the required imports. If no knowledge of the parent module is available, spurious problems
			can be reported. In such cases, the spurious problems are annoying and may obscure reported problems that are actually relevant.
		</p>
		<p>The <strong>Inferred Imports</strong> feature prevents spurious problems being highlighted in the editor.
			With this featue, a search is made to find if the active XSLT stylesheet has been declared as an import by another stylesheet opened recently
			in Visual Studio Code. If such a 'parent' stylesheet is found (the most recently opened example is used) it is imported along with any other imports. Functions and,
			variables etc. used in the active stylehseet can therefore be resolved.
		</p>
		<h5>Unused Variables</h5>
		<p>The Code Checker detects unused variables and parameters declared in either XSLT or XPath expressions. These are highlighted by being 'grayed out' in
			the editor. Global variables are shown as unused if they are not referenced in the current file, the 'unused' state is not affected by
			imported stylesheets thay may reference the same variable.
		</p>
		<h5>Compile-time and Run-time problems</h5>
		<p>The Code Checking feature is designed to find most basic code problems due to typos or changes to referenced symbols.
			When XSLT is run, an attempt is made to parse error messages from the Saxon XSLT procesor 
			(shown in the Task tab of the Terminal View) so that the problem token is highlighted,
			and the error message is shown in the Problems View.	
		</p>

		<aside>
			<p>Advantages of using the native code-checker to supplement compile-time error detection:</p>
			<ul>
				<li>Improved response times (lower CPU usage) as you type</li>
				<li>Improved precision on error location</li>
				<li>Improved potential to report multiple errors</li>
				<li>Provides warnings on unused variable references etc.</li>
			</ul>		
		</aside>

		<p>You can quickly create a new XSLT file when adding a <code>xsl:import</code>, <code>xsl:use-package</code> or <code>xsl:include</code> XSLT instruction. Simply enter the file path
			in the href, press <span class="shortcut">⌘+click</span> and then, in the 'Unable to Open...' dialog press the <strong>Create File</strong> button.</p>
		
		<aside>Note that for the XSLT <code>xsl:use-package</code> instruction, you first need to map the URI to a file path as the User or WorkSpace Setting:
			<strong>XSLT.resources.xsltPackage</strong></aside>
	</div>
	</div>
</body>

</html>